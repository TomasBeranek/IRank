{
    "label_source": "auto_labeler",
    "bug_type": "NULL_DEREFERENCE",
    "project": "libtiff",
    "bug_info": {
        "qualifier": "pointer `currenttime` last assigned on line 3955 could be null and is dereferenced at line 3958, column 5.",
        "file": "tools/tiff2pdf.c",
        "procedure": "t2p_pdf_currenttime",
        "line": 3958,
        "column": 5,
        "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3958"
    },
    "adjusted_bug_loc": null,
    "bug_loc_trace_index": -1,
    "versions": {
        "before": "b69a1998bedfabc32cd541408bffdef05bd01e45",
        "after": "519b72700430b84c99db73a832c4c58f3e52ebcd"
    },
    "sample_type": "before_fix",
    "trace": [
        {
            "idx": 0,
            "level": 0,
            "description": "start of procedure t2p_pdf_currenttime()",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3944:1",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3944"
        },
        {
            "idx": 1,
            "level": 0,
            "description": "Taking true branch",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3949:6",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3949"
        },
        {
            "idx": 2,
            "level": 0,
            "description": "Skipping strerror(): method has no implementation",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3950:3",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3950"
        },
        {
            "idx": 3,
            "level": 1,
            "description": "start of procedure TIFFError()",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "50:1",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L50"
        },
        {
            "idx": 4,
            "level": 1,
            "description": "",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "54:2",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L54"
        },
        {
            "idx": 5,
            "level": 1,
            "description": "Taking true branch",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "55:6",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L55"
        },
        {
            "idx": 6,
            "level": 1,
            "description": "Skipping __function_pointer__(): unresolved function pointer",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "56:3",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L56"
        },
        {
            "idx": 7,
            "level": 1,
            "description": "Taking true branch",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "57:6",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L57"
        },
        {
            "idx": 8,
            "level": 1,
            "description": "Skipping __function_pointer__(): unresolved function pointer",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "58:3",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L58"
        },
        {
            "idx": 9,
            "level": 1,
            "description": "",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "59:2",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L59"
        },
        {
            "idx": 10,
            "level": 1,
            "description": "return from a call to TIFFError",
            "func_removed": null,
            "file_removed": null,
            "file": "libtiff/tif_error.c",
            "loc": "60:1",
            "func_name": "TIFFError",
            "func_key": "libtiff/tif_error.c@50:1-60:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/libtiff/tif_error.c/#L60"
        },
        {
            "idx": 11,
            "level": 0,
            "description": "",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3952:3",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3952"
        },
        {
            "idx": 12,
            "level": 0,
            "description": "",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3955:2",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3955"
        },
        {
            "idx": 13,
            "level": 0,
            "description": "",
            "func_removed": null,
            "file_removed": null,
            "file": "tools/tiff2pdf.c",
            "loc": "3956:2",
            "func_name": "t2p_pdf_currenttime",
            "func_key": "tools/tiff2pdf.c@3944:1-3966:2",
            "is_func_definition": true,
            "url": "https://gitlab.com/libtiff/libtiff/blob/b69a1998bedfabc32cd541408bffdef05bd01e45/tools/tiff2pdf.c/#L3956"
        }
    ],
    "functions": {
        "tools/tiff2pdf.c@3944:1-3966:2": {
            "file": "tools/tiff2pdf.c",
            "loc": "3944:1-3966:2",
            "name": "t2p_pdf_currenttime",
            "touched_by_commit": false,
            "code": "void t2p_pdf_currenttime(T2P* t2p)\n{\n\tstruct tm* currenttime;\n\ttime_t timenow;\n\n\tif (time(&timenow) == (time_t) -1) {\n\t\tTIFFError(TIFF2PDF_MODULE,\n\t\t\t  \"Can't get the current time: %s\", strerror(errno));\n\t\ttimenow = (time_t) 0;\n\t}\n\n\tcurrenttime = localtime(&timenow);\n\tsnprintf(t2p->pdf_datetime, sizeof(t2p->pdf_datetime),\n\t\t \"D:%.4d%.2d%.2d%.2d%.2d%.2d\",\n\t\t (currenttime->tm_year + 1900) % 65536,\n\t\t (currenttime->tm_mon + 1) % 256,\n\t\t (currenttime->tm_mday) % 256,\n\t\t (currenttime->tm_hour) % 256,\n\t\t (currenttime->tm_min) % 256,\n\t\t (currenttime->tm_sec) % 256);\n\n\treturn;\n}"
        },
        "libtiff/tif_error.c@50:1-60:2": {
            "file": "libtiff/tif_error.c",
            "loc": "50:1-60:2",
            "name": "TIFFError",
            "touched_by_commit": false,
            "code": "void\nTIFFError(const char* module, const char* fmt, ...)\n{\n\tva_list ap;\n\tva_start(ap, fmt);\n\tif (_TIFFerrorHandler)\n\t\t(*_TIFFerrorHandler)(module, fmt, ap);\n\tif (_TIFFerrorHandlerExt)\n\t\t(*_TIFFerrorHandlerExt)(0, module, fmt, ap);\n\tva_end(ap);\n}"
        }
    },
    "commit": {
        "url": "https://gitlab.com/libtiff/libtiff/commit/519b72700430b84c99db73a832c4c58f3e52ebcd",
        "changes": [
            {
                "before": "ChangeLog",
                "after": "ChangeLog",
                "changes": [
                    "2,0^^3,13"
                ]
            },
            {
                "before": "configure",
                "after": "configure",
                "changes": [
                    "787,1^^786,0",
                    "834,1^^832,0",
                    "837,3^^834,0",
                    "16927,1^^16921,0",
                    "16928,0^^16923,9",
                    "16929,0^^16933,2",
                    "16954,1^^16959,9"
                ]
            },
            {
                "before": "configure.ac",
                "after": "configure.ac",
                "changes": [
                    "251,1^^250,0",
                    "252,0^^252,9",
                    "253,0^^262,2",
                    "268,1^^278,9"
                ]
            },
            {
                "before": "libtiff/tif_dumpmode.c",
                "after": "libtiff/tif_dumpmode.c",
                "changes": [
                    "1,1^^1,1",
                    "83,1^^83,1"
                ]
            },
            {
                "before": "libtiff/tif_luv.c",
                "after": "libtiff/tif_luv.c",
                "changes": [
                    "1,1^^1,1",
                    "227,1^^227,1",
                    "285,1^^285,1",
                    "350,1^^350,1"
                ]
            },
            {
                "before": "libtiff/tif_lzw.c",
                "after": "libtiff/tif_lzw.c",
                "changes": [
                    "1,1^^1,1",
                    "552,1^^552,1",
                    "756,1^^756,1"
                ]
            },
            {
                "before": "libtiff/tif_print.c",
                "after": "libtiff/tif_print.c",
                "changes": [
                    "1,1^^1,1",
                    "96,1^^96,1",
                    "104,1^^104,1",
                    "110,1^^110,1",
                    "215,1^^215,1",
                    "521,1^^521,1",
                    "634,1^^634,1"
                ]
            },
            {
                "before": "libtiff/tif_read.c",
                "after": "libtiff/tif_read.c",
                "changes": [
                    "1,1^^1,1",
                    "125,1^^125,1",
                    "377,1^^377,1",
                    "404,1^^404,1",
                    "455,1^^455,1",
                    "494,1^^494,1",
                    "540,1^^540,1",
                    "673,1^^673,1",
                    "702,1^^702,1",
                    "779,1^^779,1"
                ]
            },
            {
                "before": "libtiff/tif_strip.c",
                "after": "libtiff/tif_strip.c",
                "changes": [
                    "1,1^^1,1",
                    "155,1^^155,1"
                ]
            },
            {
                "before": "libtiff/tif_thunder.c",
                "after": "libtiff/tif_thunder.c",
                "changes": [
                    "1,1^^1,1",
                    "146,1^^146,1"
                ]
            },
            {
                "before": "tools/tiff2pdf.c",
                "after": "tools/tiff2pdf.c",
                "changes": [
                    "1,1^^1,1",
                    "3681,1^^3681,1"
                ]
            },
            {
                "before": "tools/tiffdump.c",
                "after": "tools/tiffdump.c",
                "changes": [
                    "1,1^^1,1",
                    "83,1^^83,1",
                    "339,1^^339,1",
                    "386,1^^386,1"
                ]
            }
        ]
    },
    "compiler_args": {
        "tools/tiff2pdf.c": "-DHAVE_CONFIG_H -I<$repo$>/tools -I<$repo$>/libtiff",
        "libtiff/tif_error.c": "-DHAVE_CONFIG_H -I<$repo$>/libtiff -DPIC"
    },
    "zipped_bug_report": "H4sIAHFjQ18C/72WbU/bMBDHX7ef4sTULelCaEMT2lTwZgVt0h6Qxt4umMShEYkdOQ57QHz33aVPKaSMAlul1Kl9d/39zz7br5yh229rKdNiTydx7ORRbIf+/sgd+sCVksqHz2WawoQrHuMjQt4GyGUiNFdwHpYK+7ROMn4OKSs0sKJILgWPQApIE8EBY7kQyjKN4IKDoGBMRJAUEK1iRsD00nxooX1aZgJcu90ENxj4fR8KzZQGGUOuJEYoFQft5AEaBTUsw2yjg2MDdPfobd8GagY2XMskavQ4c067NGCiUvp8JwfXhhtqPRtahVZlqEFnXaj5jZtZR77nwxm7SsQloB+HC8VEOKVYBxiLPAOMhY2QP8bUPZwhjnA0icGomF7PDUw4PJx1BdqE3b6JVLD6EKrbQ8fW2YeTk2OaQIPenNPJSfDpy+Tbx2OLTPpk0gLYecfEGw2XHAmmfKGmovGhU+xYmGVVrQMDv4U0zWaVbs/f9+HrVZLnpHPpZPqQcT2VEUxZAUJCkuUpRyWa6USKp6h9hMC1bDxHKro75D7HgRpMDxORJheUBUpFUHliLjATzWtzxUvrimTfUou6sSFJtB6XKw67EHzlE0qBxRVOmepCJqMy5VQkq7440xbYtk2xiflmA93Ad3xY2mCL9dC6ZkGaUO3mY+oazLoqDQbLLQpujttQY3PnsxUQYRX8PRZ1ylX1/1QjLaN7f9BYoFe4LDc3JdHdUDRbAj/MWauaLaHR/GBT5OOf2tygylsrkiCISxFSGQTz/TQIqGBKoXgh02vcFBcGiw33GWK31FdLzMNK0WC4ITKNGz0LHjvpB5sn/SWl/VXQ+rrYXh06jWaTxEVkPCB4+BLr4YXFP0lvLV13lQN4PdrqmjMwWmxH/wSrAWYJOqPCFrfZZjiv2skV16USECuZAYOQ4fVFy9XG/IJoC6IlYb86GjxnfjQ0nrsOLaH/cOg/fBKuHbi0Qd/Sy4Ay2wTtVrN+15QG8HftRoX/kkpM+fqdoDaN6FLdx0SusB5iAy9tu0d0nYuY5mSPUpLfXDaMmFVKaNm1YGfid+xB1LGde8+O1SzBW0jYjvx5wHXdjyGnu3RlZtTQdo90FvziTMFb6I96PRM64Lnuvme1/wDxZ/+jDgwAAA=="
}
